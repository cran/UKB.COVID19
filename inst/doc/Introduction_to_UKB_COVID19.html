<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Longfei Wang" />

<meta name="date" content="2024-07-22" />

<title>Introduction to the UKB.COVID19 Package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to the UKB.COVID19
Package</h1>
<h4 class="author">Longfei Wang</h4>
<h4 class="date">2024-07-22</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; here() starts at /tmp/RtmpinvnHJ/Rbuild6e352bf5a66b/UKB.COVID19</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   1.0.2</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; ✔ tibble  3.1.3     ✔ dplyr   1.0.7</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; ✔ tidyr   1.1.3     ✔ stringr 1.4.0</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; ✔ readr   2.0.0     ✔ forcats 0.5.1</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">library</span>(questionr)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;data.table&#39;</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;     between, first, last</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:purrr&#39;:</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt;     transpose</span></span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p><code>UKB.COVID19</code> is an R package designed to process and
analyze COVID-19 data from the UK Biobank (UKBB). It provides tools to
summarize COVID-19 test results, perform association tests between
COVID-19 outcomes and potential risk factors, and generate input files
for genome-wide association studies (GWAS).</p>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>To install the <code>UKB.COVID19</code> package, you can use the
following commands:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Install from CRAN</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># install.packages(&quot;UKB.COVID19&quot;)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">library</span>(UKB.COVID19)</span></code></pre></div>
</div>
<div id="data-preparation" class="section level1">
<h1>Data Preparation</h1>
<p>Before using the package, ensure you have access to the UKBB COVID-19
data. You will need to download the relevant datasets and have them
ready for analysis. Due to the restriction of using UKBB data, we
illustrate the use cases using simulated data, which are located in the
package UKB.COVID19/inst/extdata/ and can be retrieved with function
<code>covid_example</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ukb.tab.file <span class="ot">&lt;-</span> <span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ukb.tab <span class="ot">&lt;-</span> <span class="fu">fread</span>((ukb.tab.file))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">head</span>(ukb.tab)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;    f.eid f.31.0.0 f.34.0.0 f.189.0.0 f.22000.0.0 f.22001.0.0 f.22006.0.0</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 1:     1        1     1946   5.43719          68           1           1</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 2:    10        1     1942   1.40624          24           1           1</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 3:   100        1     1941   4.63744          42           1           1</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 4:  1000        1     1952  -2.77915          39           1          NA</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 5:   101        0     1964  -0.37771          67           0          NA</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 6:   102        1     1950  -3.96542          87           1           1</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;    f.22009.0.1 f.22009.0.2 f.22009.0.3 f.22009.0.4 f.22009.0.5 f.22009.0.6</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 1:    -13.9392     4.85521    -4.42933     4.76797    -5.27259   -0.269446</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; 2:    -12.1606     5.62572     2.45384     1.40648     1.50922    0.107995</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 3:    -10.5560     3.36640    -2.12175     1.03620    -3.17226    0.127207</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; 4:     -9.9151    -2.97417     3.31737     3.63140    -2.30812   -1.860270</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; 5:    398.7770    74.77010    -7.22445     8.38355    -2.87911   -1.455690</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; 6:    -12.3537     2.15466    -7.18555     1.01765    -6.70759    1.308840</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;    f.22009.0.7 f.22009.0.8 f.22009.0.9 f.22009.0.10 f.22009.0.11 f.22009.0.12</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; 1:  -0.0337125   -1.944710   -2.022410     4.264140      3.39439    -0.358951</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; 2:   2.6235900    0.635440    2.732790    -0.953065     -2.35587     2.528090</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt; 3:   0.1696250   -1.246840   -0.162799     1.322950      4.31400    -1.037140</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; 4:   1.7189500   -0.517634   -1.981150     1.171880     -3.98168     1.648390</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; 5:  -3.5668300   -0.135274   -1.162200     1.668700     -3.70156    -4.097650</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; 6:   0.7505630   -1.550410    3.116950    -0.228453     -2.84932     3.451730</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt;    f.22009.0.13 f.22009.0.14 f.22009.0.15 f.22009.0.16 f.22009.0.17</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt; 1:   -0.7642600     0.309769   -0.6725160    -7.448340    3.0069300</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt; 2:   -3.3455400     0.215570   -0.9274520     1.873160    1.1482700</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt; 3:   -1.5557500    -0.224190   -0.0482866    -1.543140   -2.0899200</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt; 4:   -0.0366804    -2.211790    0.4448880    -0.741873   -3.5272100</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt; 5:   -2.7702100     0.916237   -1.1581300    -0.435394    3.5632800</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt; 6:    2.2152100     1.830150   -0.1968530     4.681340   -0.0273429</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;    f.22009.0.18 f.22009.0.19 f.22009.0.20 f.22019.0.0 f.22021.0.0 f.22027.0.0</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt; 1:    -2.417060   -2.6010700   -0.0485761          NA           1          NA</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt; 2:     1.792240   -0.0429964   -4.3764600          NA           0          NA</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt; 3:    -2.102530    1.4131500    0.5887800          NA           0          NA</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co">#&gt; 4:     2.813790    1.6533800    2.8949100          NA           1          NA</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt; 5:    -0.658508   -0.3008150   -1.0726500          NA           0          NA</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt; 6:     4.608150    0.6033540   -0.6772270          NA           0          NA</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt;    f.22028.0.0 f.22029.0.0 f.22030.0.0 f.21001.0.0 f.21001.1.0 f.21001.2.0</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt; 1:           1           1           1     39.0947          NA          NA</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt; 2:           1           1           1     26.9972          NA          NA</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt; 3:           1           1           1     39.1328          NA          NA</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="co">#&gt; 4:           1           1           1     26.1228          NA          NA</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="co">#&gt; 5:           1           1           1     33.1313          NA          NA</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="co">#&gt; 6:           1           1           1     26.4349          NA          NA</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co">#&gt;    f.21001.3.0 f.21000.0.0 f.21000.1.0 f.21000.2.0 f.20161.0.0 f.20161.1.0</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a><span class="co">#&gt; 1:          NA        1001          NA          NA          NA          NA</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a><span class="co">#&gt; 2:          NA        1001          NA          NA          NA          NA</span></span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a><span class="co">#&gt; 3:          NA        1001          NA          NA          NA          NA</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="co">#&gt; 4:          NA        1001          NA          NA          NA          NA</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a><span class="co">#&gt; 5:          NA        4001          NA          NA          NA          NA</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a><span class="co">#&gt; 6:          NA        1001          NA          NA          NA          NA</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a><span class="co">#&gt;    f.20161.2.0 f.20161.3.0</span></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="co">#&gt; 1:          NA          NA</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="co">#&gt; 2:          NA          NA</span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="co">#&gt; 3:          NA          NA</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a><span class="co">#&gt; 4:          NA          NA</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co">#&gt; 5:          NA          NA</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a><span class="co">#&gt; 6:          NA          NA</span></span></code></pre></div>
</div>
<div id="main-functions" class="section level1">
<h1>Main Functions</h1>
<div id="generating-a-covariate-table-with-covid-19-risk-factors" class="section level2">
<h2>1. Generating a Covariate Table with COVID-19 Risk Factors</h2>
<p>The <code>risk_factor</code> function generates a covariate table
with risk factors using UKBB main tab data. Automatically returns sex,
age at birthday in 2020, SES, self-reported ethnicity, most recently
reported BMI, most recently reported pack-years, whether they reside in
aged care (based on hospital admissions data, and covid test data) and
blood type. Function also allows user to specify fields of interest
(field codes, provided by UK Biobank), and allows the users to specify
more intuitive names, for selected fields.</p>
<p>Note: the ukb.tab file must include fields: f.eid, f.31.0.0,
f.34.0.0, f.189.0.0, f.21001., f.21000., f.20161.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">risk_factor</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                     <span class="at">ABO.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_covid19_misc.txt.gz&quot;</span>),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                     <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                     <span class="at">res.eng=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_result_england.txt.gz&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">head</span>(covar)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;   ID sex age     bmi ethnic other.ppl black asian mixed white      SES  smoke</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 1  1   1  74 39.0947   1001         0     0     0     0     1  5.43719  0.000</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 2  2   1  58 25.3177   1001         0     0     0     0     1 -2.10787  0.000</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 3  3   0  51 32.2349   1002         0     0     0     0     1  7.36321 25.625</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; 4  4   0  56 21.7955   1001         0     0     0     0     1 -5.62047  0.000</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 5  5   0  72 22.6203   1001         0     0     0     0     1 -1.09293  0.000</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 6  6   1  67 25.9823   1001         0     0     0     0     1 -3.90245  0.000</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;   blood_group O AB B A inAgedCare</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 1          AO 0  0 0 1          0</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 2          AO 0  0 0 1          0</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 3          AO 0  0 0 1          0</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; 4          AO 0  0 0 1          0</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; 5          AO 0  0 0 1          0</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; 6          OO 1  0 0 0          0</span></span></code></pre></div>
</div>
<div id="summarizing-covid-19-test-results" class="section level2">
<h2>2. Summarizing COVID-19 Test Results</h2>
<p>The <code>makePhenotypes</code> function summarizes COVID-19 test
results, death register data, and hospital inpatient data. It generates
phenotypes for COVID-19 susceptibility, severity, and mortality.</p>
<div id="covid-19-susceptibility" class="section level3">
<h3>COVID-19 susceptibility</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>susceptibility <span class="ot">&lt;-</span> <span class="fu">makePhenotypes</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                        <span class="at">res.eng=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_result_england.txt.gz&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                        <span class="at">death.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death.txt.gz&quot;</span>),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                        <span class="at">death.cause.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death_cause.txt.gz&quot;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                        <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                        <span class="at">hesin_diag.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_diag.txt.gz&quot;</span>),</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                        <span class="at">hesin_oper.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_oper.txt.gz&quot;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                        <span class="at">hesin_critical.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_critical.txt.gz&quot;</span>),</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                        <span class="at">code.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;coding240.txt.gz&quot;</span>),</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                        <span class="at">pheno.type =</span> <span class="st">&quot;susceptibility&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;965 participants got tested until 2021-04-05.&quot;</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;218 participants got positive test results until 2021-04-05.&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 21 deaths with COVID-19. 20 of them primary death cause is COVID-19.&quot;</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;50 patients admitted to hospital were diagnosed as COVID-19 until 2021-04-05.&quot;</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;32 patients&#39; primary diagnosis is COVID-19.&quot;</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1 patients in hospitalization with COVID-19 diagnosis but show negative in the result file. Modified their test results.&quot;</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 219 COVID-19 patients identified. 32 individuals are admitted to hospital. 3 had been in ICU. 1 had been in advanced ICU.&quot;</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">head</span> (susceptibility)</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt;   ID pos.neg pos.ppl</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 1  1       1       1</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 2  2       0       0</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 3  3       0       0</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; 4  4       0       0</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 5  5       0       0</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; 6  6       0       0</span></span></code></pre></div>
</div>
<div id="covid-19-severity" class="section level3">
<h3>COVID-19 severity</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>severity <span class="ot">&lt;-</span> <span class="fu">makePhenotypes</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                        <span class="at">res.eng=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_result_england.txt.gz&quot;</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                        <span class="at">death.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death.txt.gz&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                        <span class="at">death.cause.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death_cause.txt.gz&quot;</span>),</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                        <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>),</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                        <span class="at">hesin_diag.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_diag.txt.gz&quot;</span>),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                        <span class="at">hesin_oper.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_oper.txt.gz&quot;</span>),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                        <span class="at">hesin_critical.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_critical.txt.gz&quot;</span>),</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                        <span class="at">code.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;coding240.txt.gz&quot;</span>),</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                        <span class="at">pheno.type =</span> <span class="st">&quot;severity&quot;</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;726 participants got tested until 2020-12-31.&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;150 participants got positive test results until 2020-12-31.&quot;</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 10 deaths with COVID-19. 9 of them primary death cause is COVID-19.&quot;</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;50 patients admitted to hospital were diagnosed as COVID-19 until 2020-12-31.&quot;</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;32 patients&#39; primary diagnosis is COVID-19.&quot;</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1 patients in hospitalization with COVID-19 diagnosis but show negative in the result file. Modified their test results.&quot;</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 151 COVID-19 patients identified. 32 individuals are admitted to hospital. 3 had been in ICU. 1 had been in advanced ICU.&quot;</span></span></code></pre></div>
</div>
<div id="covid-19-mortality" class="section level3">
<h3>COVID-19 mortality</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>mortality <span class="ot">&lt;-</span> <span class="fu">makePhenotypes</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                        <span class="at">res.eng=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_result_england.txt.gz&quot;</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                        <span class="at">death.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death.txt.gz&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                        <span class="at">death.cause.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death_cause.txt.gz&quot;</span>),</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                        <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>),</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                        <span class="at">hesin_diag.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_diag.txt.gz&quot;</span>),</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                        <span class="at">hesin_oper.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_oper.txt.gz&quot;</span>),</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                        <span class="at">hesin_critical.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_critical.txt.gz&quot;</span>),</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>                        <span class="at">code.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;coding240.txt.gz&quot;</span>),</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>                        <span class="at">pheno.type =</span> <span class="st">&quot;mortality&quot;</span>)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;939 participants got tested until 2021-03-19.&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;217 participants got positive test results until 2021-03-19.&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 21 deaths with COVID-19. 20 of them primary death cause is COVID-19.&quot;</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;50 patients admitted to hospital were diagnosed as COVID-19 until 2021-03-19.&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;32 patients&#39; primary diagnosis is COVID-19.&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1 patients in hospitalization with COVID-19 diagnosis but show negative in the result file. Modified their test results.&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 218 COVID-19 patients identified. 32 individuals are admitted to hospital. 3 had been in ICU. 1 had been in advanced ICU.&quot;</span></span></code></pre></div>
</div>
</div>
<div id="perfroming-association-tests" class="section level2">
<h2>3. Perfroming Association Tests</h2>
<p>The <code>log_cov</code> function performs association tests using
logistic regressions. This is an example of association tests between
COVID-19 susceptibility and three risk factors: sex, age and BMI.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">log_cov</span>(<span class="at">pheno=</span>susceptibility, <span class="at">covariates=</span>covar, <span class="at">phe.name=</span><span class="st">&quot;pos.neg&quot;</span>, <span class="at">cov.name=</span><span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;bmi&quot;</span>))</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;                Estimate        OR     2.5 %    97.5 %           p</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.16475743 0.8480994 0.1954585 3.6381032 0.824991899</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; sex1         0.04207813 1.0429760 0.7644672 1.4215535 0.790121307</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; age         -0.03080456 0.9696651 0.9519878 0.9876397 0.001009957</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; bmi          0.03625193 1.0369170 1.0076088 1.0667564 0.012568486</span></span></code></pre></div>
</div>
<div id="generating-a-comorbidity-summary-file" class="section level2">
<h2>4. Generating a Comorbidity Summary File</h2>
<p>The <code>comorbidity.summary</code> function scans all the
hospitalisation records with a given time period and generates
comorbidity summary table. The following example is to generate a
comorbidity summary table that includes all the primary and secondary
diagnoses in the hospital inpatient data after 16 March 2020.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>comorb <span class="ot">&lt;-</span> <span class="fu">comorbidity_summary</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                              <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>), </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                              <span class="at">hesin_diag.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_diag.txt.gz&quot;</span>), </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                              <span class="at">ICD10.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;ICD10.coding19.txt.gz&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                              <span class="at">primary =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                              <span class="at">Date.start =</span> <span class="st">&quot;16/03/2020&quot;</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>comorb[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt;     ID A00-A09 A15-A19 A20-A28 A30-A49 A50-A64 A65-A69 A70-A74 A75-A79 A80-A89</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 1    1       1       0       0       1       0       0       0       0       0</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 2   10       0       0       0       0       0       0       0       0       0</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 3  100       0       0       0       0       0       0       0       0       0</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 4 1000       0       0       0       0       0       0       0       0       0</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 5  101       0       0       0       0       0       0       0       0       0</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 6  102       0       0       0       0       0       0       0       0       0</span></span></code></pre></div>
</div>
<div id="performing-association-tests-between-covid-19-phenotype-and-comorbidities" class="section level2">
<h2>5. Performing Association Tests between COVID-19 Phenotype and
Comorbidities</h2>
<p>The <code>comorbidity.asso</code> function performs association tests
between comorbidity categories and selected phenotype using logistic
regression models.This is an example of association tests between
COVID-19 susceptibility and all comorbidities. It shows NAs when fitted
probabilities numerically 0 or 1 occurred in the logistic regression
models.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>comorb.asso <span class="ot">&lt;-</span> <span class="fu">comorbidity_asso</span>(<span class="at">pheno=</span>susceptibility,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                                <span class="at">covariates=</span>covar,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                                <span class="at">cormorbidity=</span>comorb,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                                <span class="at">population=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                                <span class="at">cov.name=</span><span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>,<span class="st">&quot;age&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;SES&quot;</span>,<span class="st">&quot;smoke&quot;</span>,<span class="st">&quot;inAgedCare&quot;</span>),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                                <span class="at">phe.name=</span><span class="st">&quot;pos.neg&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                                <span class="at">ICD10.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;ICD10.coding19.txt.gz&quot;</span>))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-66"><a href="#cb10-66" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-67"><a href="#cb10-67" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-68"><a href="#cb10-68" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-69"><a href="#cb10-69" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-70"><a href="#cb10-70" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-71"><a href="#cb10-71" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-72"><a href="#cb10-72" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-73"><a href="#cb10-73" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-74"><a href="#cb10-74" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-75"><a href="#cb10-75" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-76"><a href="#cb10-76" tabindex="-1"></a><span class="co">#&gt; Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span></span>
<span id="cb10-77"><a href="#cb10-77" tabindex="-1"></a><span class="co">#&gt; collapsing to unique &#39;x&#39; values</span></span>
<span id="cb10-78"><a href="#cb10-78" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-79"><a href="#cb10-79" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-80"><a href="#cb10-80" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-81"><a href="#cb10-81" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-82"><a href="#cb10-82" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-83"><a href="#cb10-83" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-84"><a href="#cb10-84" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-85"><a href="#cb10-85" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-86"><a href="#cb10-86" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-87"><a href="#cb10-87" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-88"><a href="#cb10-88" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-89"><a href="#cb10-89" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-90"><a href="#cb10-90" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-91"><a href="#cb10-91" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-92"><a href="#cb10-92" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-93"><a href="#cb10-93" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-94"><a href="#cb10-94" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-95"><a href="#cb10-95" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-96"><a href="#cb10-96" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-97"><a href="#cb10-97" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-98"><a href="#cb10-98" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-99"><a href="#cb10-99" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-100"><a href="#cb10-100" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-101"><a href="#cb10-101" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-102"><a href="#cb10-102" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-103"><a href="#cb10-103" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-104"><a href="#cb10-104" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-105"><a href="#cb10-105" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-106"><a href="#cb10-106" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-107"><a href="#cb10-107" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-108"><a href="#cb10-108" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-109"><a href="#cb10-109" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-110"><a href="#cb10-110" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-111"><a href="#cb10-111" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-112"><a href="#cb10-112" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-113"><a href="#cb10-113" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-114"><a href="#cb10-114" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-115"><a href="#cb10-115" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-116"><a href="#cb10-116" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-117"><a href="#cb10-117" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-118"><a href="#cb10-118" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-119"><a href="#cb10-119" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-120"><a href="#cb10-120" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-121"><a href="#cb10-121" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-122"><a href="#cb10-122" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-123"><a href="#cb10-123" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-124"><a href="#cb10-124" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-125"><a href="#cb10-125" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-126"><a href="#cb10-126" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-127"><a href="#cb10-127" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-128"><a href="#cb10-128" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-129"><a href="#cb10-129" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-130"><a href="#cb10-130" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-131"><a href="#cb10-131" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-132"><a href="#cb10-132" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-133"><a href="#cb10-133" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-134"><a href="#cb10-134" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-135"><a href="#cb10-135" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-136"><a href="#cb10-136" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-137"><a href="#cb10-137" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-138"><a href="#cb10-138" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-139"><a href="#cb10-139" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-140"><a href="#cb10-140" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-141"><a href="#cb10-141" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-142"><a href="#cb10-142" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-143"><a href="#cb10-143" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-144"><a href="#cb10-144" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-145"><a href="#cb10-145" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-146"><a href="#cb10-146" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-147"><a href="#cb10-147" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-148"><a href="#cb10-148" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-149"><a href="#cb10-149" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-150"><a href="#cb10-150" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-151"><a href="#cb10-151" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-152"><a href="#cb10-152" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-153"><a href="#cb10-153" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-154"><a href="#cb10-154" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-155"><a href="#cb10-155" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-156"><a href="#cb10-156" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-157"><a href="#cb10-157" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-158"><a href="#cb10-158" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-159"><a href="#cb10-159" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-160"><a href="#cb10-160" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-161"><a href="#cb10-161" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-162"><a href="#cb10-162" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-163"><a href="#cb10-163" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-164"><a href="#cb10-164" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-165"><a href="#cb10-165" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-166"><a href="#cb10-166" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-167"><a href="#cb10-167" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-168"><a href="#cb10-168" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-169"><a href="#cb10-169" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-170"><a href="#cb10-170" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-171"><a href="#cb10-171" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-172"><a href="#cb10-172" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-173"><a href="#cb10-173" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-174"><a href="#cb10-174" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-175"><a href="#cb10-175" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-176"><a href="#cb10-176" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-177"><a href="#cb10-177" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-178"><a href="#cb10-178" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-179"><a href="#cb10-179" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-180"><a href="#cb10-180" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-181"><a href="#cb10-181" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-182"><a href="#cb10-182" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-183"><a href="#cb10-183" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-184"><a href="#cb10-184" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-185"><a href="#cb10-185" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-186"><a href="#cb10-186" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-187"><a href="#cb10-187" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-188"><a href="#cb10-188" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-189"><a href="#cb10-189" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-190"><a href="#cb10-190" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-191"><a href="#cb10-191" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-192"><a href="#cb10-192" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-193"><a href="#cb10-193" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-194"><a href="#cb10-194" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-195"><a href="#cb10-195" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-196"><a href="#cb10-196" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb10-197"><a href="#cb10-197" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-198"><a href="#cb10-198" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-199"><a href="#cb10-199" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-200"><a href="#cb10-200" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-201"><a href="#cb10-201" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-202"><a href="#cb10-202" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-203"><a href="#cb10-203" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-204"><a href="#cb10-204" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-205"><a href="#cb10-205" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-206"><a href="#cb10-206" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-207"><a href="#cb10-207" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-208"><a href="#cb10-208" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-209"><a href="#cb10-209" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-210"><a href="#cb10-210" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-211"><a href="#cb10-211" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-212"><a href="#cb10-212" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-213"><a href="#cb10-213" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-214"><a href="#cb10-214" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-215"><a href="#cb10-215" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb10-216"><a href="#cb10-216" tabindex="-1"></a><span class="fu">head</span>(comorb.asso, <span class="dv">4</span>)</span>
<span id="cb10-217"><a href="#cb10-217" tabindex="-1"></a><span class="co">#&gt;                                               ICD10  Estimate       OR     2.5%</span></span>
<span id="cb10-218"><a href="#cb10-218" tabindex="-1"></a><span class="co">#&gt; A00-A09      A00-A09 Intestinal infectious diseases 0.4722864 1.603657 0.756784</span></span>
<span id="cb10-219"><a href="#cb10-219" tabindex="-1"></a><span class="co">#&gt; A15-A19                        A15-A19 Tuberculosis        NA       NA       NA</span></span>
<span id="cb10-220"><a href="#cb10-220" tabindex="-1"></a><span class="co">#&gt; A20-A28 A20-A28 Certain zoonotic bacterial diseases        NA       NA       NA</span></span>
<span id="cb10-221"><a href="#cb10-221" tabindex="-1"></a><span class="co">#&gt; A30-A49            A30-A49 Other bacterial diseases 1.2246077 3.402831 1.633209</span></span>
<span id="cb10-222"><a href="#cb10-222" tabindex="-1"></a><span class="co">#&gt;            97.5%           p</span></span>
<span id="cb10-223"><a href="#cb10-223" tabindex="-1"></a><span class="co">#&gt; A00-A09 3.240022 0.199664372</span></span>
<span id="cb10-224"><a href="#cb10-224" tabindex="-1"></a><span class="co">#&gt; A15-A19       NA          NA</span></span>
<span id="cb10-225"><a href="#cb10-225" tabindex="-1"></a><span class="co">#&gt; A20-A28       NA          NA</span></span>
<span id="cb10-226"><a href="#cb10-226" tabindex="-1"></a><span class="co">#&gt; A30-A49 6.978689 0.000873076</span></span></code></pre></div>
</div>
<div id="sample-and-variant-quality-control" class="section level2">
<h2>4. Sample and Variant Quality Control</h2>
<p>The <code>sampleQC</code> and <code>variantQC</code> functions
perform quality control for sample and variant data, respectively.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Example usage for sample QC</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">sampleQC</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>), </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>         <span class="at">withdrawnFile=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_withdrawn.csv.gz&quot;</span>), </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>         <span class="at">ancestry=</span><span class="st">&quot;all&quot;</span>, </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>         <span class="at">software=</span><span class="st">&quot;SAIGE&quot;</span>, </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>         <span class="at">outDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;results&quot;</span>))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reading in Withdrawn IDs from /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/sim_withdrawn.csv.gz&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reading in Sample QC info from /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/sim_ukb.tab.gz&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Outputting lists to /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co"># Example usage for variant QC</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">variantQC</span>(<span class="at">snpQcFile=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb_snp_qc.txt.gz&quot;</span>), </span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>          <span class="at">mfiDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;alleleFreqs&quot;</span>), </span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>          <span class="at">mafFilt=</span><span class="fl">0.001</span>, </span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>          <span class="at">infoFilt=</span><span class="fl">0.5</span>, </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>          <span class="at">outDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;results&quot;</span>))</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reading in SNP MAF INFO data from /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/alleleFreqs/ukb_mfi_chr*_v3.txt&quot;</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; [1] &quot;writing list of variants to include under different filters to /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results&quot;</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; [1] &quot;writing list of variants to use for genetic relatedness matrix (grm) to /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results&quot;</span></span></code></pre></div>
</div>
<div id="preparing-files-for-gwas" class="section level2">
<h2>5. Preparing Files for GWAS</h2>
<p>The <code>makeGWASFiles</code> function generates phenotype files
suitable for GWAS using tools like PLINK and SAIGE.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">makeGWASFiles</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>), </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>              <span class="at">pheno=</span>susceptibility, </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>              <span class="at">covariates=</span>covar, </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>              <span class="at">phe.name=</span><span class="st">&quot;pos.ppl&quot;</span>, </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>              <span class="at">cov.name=</span><span class="cn">NULL</span>, </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>              <span class="at">includeSampsFile=</span><span class="cn">NULL</span>, </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>              <span class="at">software=</span><span class="st">&quot;SAIGE&quot;</span>, </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>              <span class="at">outDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;results&quot;</span>), </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>              <span class="at">prefix=</span><span class="st">&quot;pos.ppl&quot;</span>)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No covriates specified - all included in covariate dataframe will be included in outfile&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;outputting phenotype file: /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results/pos.ppl.txt&quot;</span></span></code></pre></div>
</div>
</div>
<div id="example-workflow" class="section level1">
<h1>Example Workflow</h1>
<p>Here is an example workflow of analysing the risk factors of COVID-19
susceptibility, that combines the main functions of the UKB.COVID19
package:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(UKB.COVID19)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Summarize COVID-19 risk factors</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>covar <span class="ot">&lt;-</span> <span class="fu">risk_factor</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>), </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                         <span class="at">ABO.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_covid19_misc.txt.gz&quot;</span>),</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>                         <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>),</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>                         <span class="at">res.eng=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_result_england.txt.gz&quot;</span>))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># Summarize COVID-19 test results</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>susceptibility <span class="ot">&lt;-</span> <span class="fu">makePhenotypes</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>                        <span class="at">res.eng=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_result_england.txt.gz&quot;</span>),</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>                        <span class="at">death.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death.txt.gz&quot;</span>),</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>                        <span class="at">death.cause.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_death_cause.txt.gz&quot;</span>),</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>                        <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>),</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>                        <span class="at">hesin_diag.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_diag.txt.gz&quot;</span>),</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>                        <span class="at">hesin_oper.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_oper.txt.gz&quot;</span>),</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>                        <span class="at">hesin_critical.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_critical.txt.gz&quot;</span>),</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>                        <span class="at">code.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;coding240.txt.gz&quot;</span>),</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>                        <span class="at">pheno.type =</span> <span class="st">&quot;susceptibility&quot;</span>)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; [1] &quot;965 participants got tested until 2021-04-05.&quot;</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; [1] &quot;218 participants got positive test results until 2021-04-05.&quot;</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 21 deaths with COVID-19. 20 of them primary death cause is COVID-19.&quot;</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; [1] &quot;50 patients admitted to hospital were diagnosed as COVID-19 until 2021-04-05.&quot;</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; [1] &quot;32 patients&#39; primary diagnosis is COVID-19.&quot;</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; [1] &quot;1 patients in hospitalization with COVID-19 diagnosis but show negative in the result file. Modified their test results.&quot;</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;There are 219 COVID-19 patients identified. 32 individuals are admitted to hospital. 3 had been in ICU. 1 had been in advanced ICU.&quot;</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co"># Perfrom association tests</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="fu">log_cov</span>(<span class="at">pheno=</span>susceptibility, <span class="at">covariates=</span>covar, <span class="at">phe.name=</span><span class="st">&quot;pos.neg&quot;</span>, <span class="at">cov.name=</span><span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;bmi&quot;</span>))</span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt;                Estimate        OR     2.5 %    97.5 %           p</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.16475743 0.8480994 0.1954585 3.6381032 0.824991899</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt; sex1         0.04207813 1.0429760 0.7644672 1.4215535 0.790121307</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt; age         -0.03080456 0.9696651 0.9519878 0.9876397 0.001009957</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt; bmi          0.03625193 1.0369170 1.0076088 1.0667564 0.012568486</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co"># Generate comorbidity table</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a>comorb <span class="ot">&lt;-</span> <span class="fu">comorbidity_summary</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>),</span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a>                              <span class="at">hesin.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin.txt.gz&quot;</span>), </span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a>                              <span class="at">hesin_diag.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_hesin_diag.txt.gz&quot;</span>), </span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a>                              <span class="at">ICD10.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;ICD10.coding19.txt.gz&quot;</span>),</span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a>                              <span class="at">primary =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>                              <span class="at">Date.start =</span> <span class="st">&quot;16/03/2020&quot;</span>)</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a><span class="co"># Perform association tests between COVID-19 phenotype and comorbidities</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a>comorb.asso <span class="ot">&lt;-</span> <span class="fu">comorbidity_asso</span>(<span class="at">pheno=</span>susceptibility,</span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a>                                <span class="at">covariates=</span>covar,</span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a>                                <span class="at">cormorbidity=</span>comorb,</span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a>                                <span class="at">population=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a>                                <span class="at">cov.name=</span><span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>,<span class="st">&quot;age&quot;</span>,<span class="st">&quot;bmi&quot;</span>,<span class="st">&quot;SES&quot;</span>,<span class="st">&quot;smoke&quot;</span>,<span class="st">&quot;inAgedCare&quot;</span>),</span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a>                                <span class="at">phe.name=</span><span class="st">&quot;pos.neg&quot;</span>,</span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a>                                <span class="at">ICD10.file=</span><span class="fu">covid_example</span>(<span class="st">&quot;ICD10.coding19.txt.gz&quot;</span>))</span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-64"><a href="#cb13-64" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-65"><a href="#cb13-65" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-66"><a href="#cb13-66" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-67"><a href="#cb13-67" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-68"><a href="#cb13-68" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-69"><a href="#cb13-69" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-70"><a href="#cb13-70" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-71"><a href="#cb13-71" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-72"><a href="#cb13-72" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-73"><a href="#cb13-73" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-74"><a href="#cb13-74" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-75"><a href="#cb13-75" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-76"><a href="#cb13-76" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-77"><a href="#cb13-77" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-78"><a href="#cb13-78" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-79"><a href="#cb13-79" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-80"><a href="#cb13-80" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-81"><a href="#cb13-81" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-82"><a href="#cb13-82" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-83"><a href="#cb13-83" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-84"><a href="#cb13-84" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-85"><a href="#cb13-85" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-86"><a href="#cb13-86" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-87"><a href="#cb13-87" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-88"><a href="#cb13-88" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-89"><a href="#cb13-89" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-90"><a href="#cb13-90" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-91"><a href="#cb13-91" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-92"><a href="#cb13-92" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-93"><a href="#cb13-93" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-94"><a href="#cb13-94" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-95"><a href="#cb13-95" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-96"><a href="#cb13-96" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-97"><a href="#cb13-97" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-98"><a href="#cb13-98" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-99"><a href="#cb13-99" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-100"><a href="#cb13-100" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-101"><a href="#cb13-101" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-102"><a href="#cb13-102" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-103"><a href="#cb13-103" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-104"><a href="#cb13-104" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-105"><a href="#cb13-105" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-106"><a href="#cb13-106" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-107"><a href="#cb13-107" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-108"><a href="#cb13-108" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-109"><a href="#cb13-109" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-110"><a href="#cb13-110" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-111"><a href="#cb13-111" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-112"><a href="#cb13-112" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-113"><a href="#cb13-113" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-114"><a href="#cb13-114" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-115"><a href="#cb13-115" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-116"><a href="#cb13-116" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-117"><a href="#cb13-117" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-118"><a href="#cb13-118" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-119"><a href="#cb13-119" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-120"><a href="#cb13-120" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-121"><a href="#cb13-121" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-122"><a href="#cb13-122" tabindex="-1"></a><span class="co">#&gt; Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span></span>
<span id="cb13-123"><a href="#cb13-123" tabindex="-1"></a><span class="co">#&gt; collapsing to unique &#39;x&#39; values</span></span>
<span id="cb13-124"><a href="#cb13-124" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-125"><a href="#cb13-125" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-126"><a href="#cb13-126" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-127"><a href="#cb13-127" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-128"><a href="#cb13-128" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-129"><a href="#cb13-129" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-130"><a href="#cb13-130" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-131"><a href="#cb13-131" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-132"><a href="#cb13-132" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-133"><a href="#cb13-133" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-134"><a href="#cb13-134" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-135"><a href="#cb13-135" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-136"><a href="#cb13-136" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-137"><a href="#cb13-137" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-138"><a href="#cb13-138" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-139"><a href="#cb13-139" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-140"><a href="#cb13-140" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-141"><a href="#cb13-141" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-142"><a href="#cb13-142" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-143"><a href="#cb13-143" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-144"><a href="#cb13-144" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-145"><a href="#cb13-145" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-146"><a href="#cb13-146" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-147"><a href="#cb13-147" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-148"><a href="#cb13-148" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-149"><a href="#cb13-149" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-150"><a href="#cb13-150" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-151"><a href="#cb13-151" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-152"><a href="#cb13-152" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-153"><a href="#cb13-153" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-154"><a href="#cb13-154" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-155"><a href="#cb13-155" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-156"><a href="#cb13-156" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-157"><a href="#cb13-157" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-158"><a href="#cb13-158" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-159"><a href="#cb13-159" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-160"><a href="#cb13-160" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-161"><a href="#cb13-161" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-162"><a href="#cb13-162" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-163"><a href="#cb13-163" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-164"><a href="#cb13-164" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-165"><a href="#cb13-165" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-166"><a href="#cb13-166" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-167"><a href="#cb13-167" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-168"><a href="#cb13-168" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-169"><a href="#cb13-169" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-170"><a href="#cb13-170" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-171"><a href="#cb13-171" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-172"><a href="#cb13-172" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-173"><a href="#cb13-173" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-174"><a href="#cb13-174" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-175"><a href="#cb13-175" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-176"><a href="#cb13-176" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-177"><a href="#cb13-177" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-178"><a href="#cb13-178" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-179"><a href="#cb13-179" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-180"><a href="#cb13-180" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-181"><a href="#cb13-181" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-182"><a href="#cb13-182" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-183"><a href="#cb13-183" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-184"><a href="#cb13-184" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-185"><a href="#cb13-185" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-186"><a href="#cb13-186" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-187"><a href="#cb13-187" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-188"><a href="#cb13-188" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-189"><a href="#cb13-189" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-190"><a href="#cb13-190" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-191"><a href="#cb13-191" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-192"><a href="#cb13-192" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-193"><a href="#cb13-193" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-194"><a href="#cb13-194" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-195"><a href="#cb13-195" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-196"><a href="#cb13-196" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-197"><a href="#cb13-197" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-198"><a href="#cb13-198" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-199"><a href="#cb13-199" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-200"><a href="#cb13-200" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-201"><a href="#cb13-201" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-202"><a href="#cb13-202" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-203"><a href="#cb13-203" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-204"><a href="#cb13-204" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-205"><a href="#cb13-205" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-206"><a href="#cb13-206" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-207"><a href="#cb13-207" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-208"><a href="#cb13-208" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-209"><a href="#cb13-209" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-210"><a href="#cb13-210" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-211"><a href="#cb13-211" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-212"><a href="#cb13-212" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-213"><a href="#cb13-213" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-214"><a href="#cb13-214" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-215"><a href="#cb13-215" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-216"><a href="#cb13-216" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-217"><a href="#cb13-217" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-218"><a href="#cb13-218" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-219"><a href="#cb13-219" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-220"><a href="#cb13-220" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-221"><a href="#cb13-221" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-222"><a href="#cb13-222" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-223"><a href="#cb13-223" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-224"><a href="#cb13-224" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-225"><a href="#cb13-225" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-226"><a href="#cb13-226" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-227"><a href="#cb13-227" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-228"><a href="#cb13-228" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-229"><a href="#cb13-229" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-230"><a href="#cb13-230" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-231"><a href="#cb13-231" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-232"><a href="#cb13-232" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-233"><a href="#cb13-233" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-234"><a href="#cb13-234" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-235"><a href="#cb13-235" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-236"><a href="#cb13-236" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-237"><a href="#cb13-237" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-238"><a href="#cb13-238" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-239"><a href="#cb13-239" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-240"><a href="#cb13-240" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-241"><a href="#cb13-241" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-242"><a href="#cb13-242" tabindex="-1"></a><span class="co">#&gt; Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb13-243"><a href="#cb13-243" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-244"><a href="#cb13-244" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-245"><a href="#cb13-245" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-246"><a href="#cb13-246" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-247"><a href="#cb13-247" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-248"><a href="#cb13-248" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-249"><a href="#cb13-249" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-250"><a href="#cb13-250" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-251"><a href="#cb13-251" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-252"><a href="#cb13-252" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-253"><a href="#cb13-253" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-254"><a href="#cb13-254" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-255"><a href="#cb13-255" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-256"><a href="#cb13-256" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-257"><a href="#cb13-257" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-258"><a href="#cb13-258" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-259"><a href="#cb13-259" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-260"><a href="#cb13-260" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-261"><a href="#cb13-261" tabindex="-1"></a><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span id="cb13-262"><a href="#cb13-262" tabindex="-1"></a></span>
<span id="cb13-263"><a href="#cb13-263" tabindex="-1"></a><span class="co"># Perform sample quality control</span></span>
<span id="cb13-264"><a href="#cb13-264" tabindex="-1"></a><span class="fu">sampleQC</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>), </span>
<span id="cb13-265"><a href="#cb13-265" tabindex="-1"></a>         <span class="at">withdrawnFile=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_withdrawn.csv.gz&quot;</span>), </span>
<span id="cb13-266"><a href="#cb13-266" tabindex="-1"></a>         <span class="at">ancestry=</span><span class="st">&quot;all&quot;</span>, </span>
<span id="cb13-267"><a href="#cb13-267" tabindex="-1"></a>         <span class="at">software=</span><span class="st">&quot;SAIGE&quot;</span>, </span>
<span id="cb13-268"><a href="#cb13-268" tabindex="-1"></a>         <span class="at">outDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;results&quot;</span>))</span>
<span id="cb13-269"><a href="#cb13-269" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reading in Withdrawn IDs from /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/sim_withdrawn.csv.gz&quot;</span></span>
<span id="cb13-270"><a href="#cb13-270" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reading in Sample QC info from /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/sim_ukb.tab.gz&quot;</span></span>
<span id="cb13-271"><a href="#cb13-271" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Outputting lists to /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results&quot;</span></span>
<span id="cb13-272"><a href="#cb13-272" tabindex="-1"></a></span>
<span id="cb13-273"><a href="#cb13-273" tabindex="-1"></a><span class="co"># Perform variant quality control</span></span>
<span id="cb13-274"><a href="#cb13-274" tabindex="-1"></a><span class="fu">variantQC</span>(<span class="at">snpQcFile=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb_snp_qc.txt.gz&quot;</span>), </span>
<span id="cb13-275"><a href="#cb13-275" tabindex="-1"></a>          <span class="at">mfiDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;alleleFreqs&quot;</span>), </span>
<span id="cb13-276"><a href="#cb13-276" tabindex="-1"></a>          <span class="at">mafFilt=</span><span class="fl">0.001</span>, </span>
<span id="cb13-277"><a href="#cb13-277" tabindex="-1"></a>          <span class="at">infoFilt=</span><span class="fl">0.5</span>, </span>
<span id="cb13-278"><a href="#cb13-278" tabindex="-1"></a>          <span class="at">outDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;results&quot;</span>))</span>
<span id="cb13-279"><a href="#cb13-279" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reading in SNP MAF INFO data from /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/alleleFreqs/ukb_mfi_chr*_v3.txt&quot;</span></span>
<span id="cb13-280"><a href="#cb13-280" tabindex="-1"></a><span class="co">#&gt; [1] &quot;writing list of variants to include under different filters to /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results&quot;</span></span>
<span id="cb13-281"><a href="#cb13-281" tabindex="-1"></a><span class="co">#&gt; [1] &quot;writing list of variants to use for genetic relatedness matrix (grm) to /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results&quot;</span></span>
<span id="cb13-282"><a href="#cb13-282" tabindex="-1"></a></span>
<span id="cb13-283"><a href="#cb13-283" tabindex="-1"></a><span class="co"># Preparing files for GWAS</span></span>
<span id="cb13-284"><a href="#cb13-284" tabindex="-1"></a><span class="fu">makeGWASFiles</span>(<span class="at">ukb.data=</span><span class="fu">covid_example</span>(<span class="st">&quot;sim_ukb.tab.gz&quot;</span>), </span>
<span id="cb13-285"><a href="#cb13-285" tabindex="-1"></a>              <span class="at">pheno=</span>susceptibility, </span>
<span id="cb13-286"><a href="#cb13-286" tabindex="-1"></a>              <span class="at">covariates=</span>covar, </span>
<span id="cb13-287"><a href="#cb13-287" tabindex="-1"></a>              <span class="at">phe.name=</span><span class="st">&quot;pos.ppl&quot;</span>, </span>
<span id="cb13-288"><a href="#cb13-288" tabindex="-1"></a>              <span class="at">cov.name=</span><span class="cn">NULL</span>, </span>
<span id="cb13-289"><a href="#cb13-289" tabindex="-1"></a>              <span class="at">includeSampsFile=</span><span class="cn">NULL</span>, </span>
<span id="cb13-290"><a href="#cb13-290" tabindex="-1"></a>              <span class="at">software=</span><span class="st">&quot;SAIGE&quot;</span>, </span>
<span id="cb13-291"><a href="#cb13-291" tabindex="-1"></a>              <span class="at">outDir=</span><span class="fu">covid_example</span>(<span class="st">&quot;results&quot;</span>), </span>
<span id="cb13-292"><a href="#cb13-292" tabindex="-1"></a>              <span class="at">prefix=</span><span class="st">&quot;pos.ppl&quot;</span>)</span>
<span id="cb13-293"><a href="#cb13-293" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No covriates specified - all included in covariate dataframe will be included in outfile&quot;</span></span>
<span id="cb13-294"><a href="#cb13-294" tabindex="-1"></a><span class="co">#&gt; [1] &quot;outputting phenotype file: /tmp/RtmpinvnHJ/Rinst6e353668d3c3/UKB.COVID19/extdata/results/pos.ppl.txt&quot;</span></span></code></pre></div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>The UKB.COVID19 package provides comprehensive tools for analyzing
COVID-19 data from the UK Biobank. By following this vignette, users can
efficiently summarize data, perform association tests, and prepare files
for genetic analysis. For more detailed information, refer to the
package documentation and the GitHub repository.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
